name: Simple SSH Terminal

on:
  workflow_dispatch:  # Run manually

jobs:
  ssh-access:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # Max 6 hours

    steps:
    - name: Start SSH Server
      run: |
        sudo apt update
        sudo apt install -y openssh-server
        sudo mkdir -p /var/run/sshd

        # Set password to '1234'
        echo "root:1234" | sudo chpasswd

        # Allow root login with password
        sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config
        sudo sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config

        sudo service ssh restart

        # Get public IP
        IP=$(curl -s ifconfig.me)

        echo "======================================"
        echo "Connect using Termius:"
        echo "Host: $IP"
        echo "Port: 22"
        echo "Username: root"
        echo "Password: 1234"
        echo "======================================"
        echo "Note: Will auto-terminate after 6 hours"
        
        # Keep alive
        sleep 6h
